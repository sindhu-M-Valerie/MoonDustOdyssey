<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>🧚 Moon Dust Odyssey 🧚</title>
  <style>
    body { 
      margin: 0; 
      overflow: hidden; 
      background: linear-gradient(135deg, #1a1a3a 0%, #0f0f1f 100%); 
      position: relative;
    }
    canvas { 
      display: block; 
      margin: 0 auto; 
      position: relative;
      z-index: 1;
    }
    
    .sparkly-title {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 99999;
      font-family: 'Arial', sans-serif;
      font-size: 2.5em;
      font-weight: bold;
      text-align: center;
      color: #fff;
      background: rgba(0, 0, 0, 0.3);
      padding: 10px 20px;
      border-radius: 15px;
      text-shadow: 
        0 0 10px #ff69b4,
        0 0 20px #ff1493,
        0 0 30px #ff69b4,
        0 0 40px #ff1493,
        0 0 50px #ff69b4,
        0 0 60px #ff1493;
      animation: sparkle 2s ease-in-out infinite alternate, glow 3s ease-in-out infinite;
      letter-spacing: 3px;
      pointer-events: none;
      border: 2px solid rgba(255, 105, 180, 0.5);
    }
    
    .sparkly-title del {
      text-decoration: line-through;
      text-decoration-color: #ff1493;
      text-decoration-thickness: 3px;
      opacity: 0.7;
    }
    
    @keyframes sparkle {
      0% {
        text-shadow: 
          0 0 10px #ff69b4,
          0 0 20px #ff1493,
          0 0 30px #ff69b4,
          0 0 40px #ff1493,
          0 0 50px #ff69b4,
          0 0 60px #ff1493;
      }
      50% {
        text-shadow: 
          0 0 15px #9370db,
          0 0 25px #8a2be2,
          0 0 35px #9370db,
          0 0 45px #8a2be2,
          0 0 55px #9370db,
          0 0 65px #8a2be2;
      }
      100% {
        text-shadow: 
          0 0 10px #00ffff,
          0 0 20px #00bfff,
          0 0 30px #00ffff,
          0 0 40px #00bfff,
          0 0 50px #00ffff,
          0 0 60px #00bfff;
      }
    }
    
    @keyframes glow {
      0%, 100% {
        transform: translateX(-50%) scale(1);
      }
      50% {
        transform: translateX(-50%) scale(1.05);
      }
    }
  </style>
</head>
<body>
<div class="sparkly-title">🧚 Moon Dust Odyssey🧚</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
<script>
let cat;
let gravity = 0.6;
let jumpForce = -10;
let platforms = [];
let moonRotation = 0;
let score = 0;
let stars = [];
let moonEmoji;
let browniePoints = 0;
let showBrownieMessage = false;
let brownieMessageTimer = 0;
let brownieMessageAlpha = 0;

function setup() {
  createCanvas(windowWidth, windowHeight);
  cat = new Cat();
  for (let i = 0; i < 8; i++) {
    platforms.push(new Platform(i));
  }
  
  // Create twinkling stars
  for (let i = 0; i < 100; i++) {
    stars.push({
      x: random(-width, width),
      y: random(-height, height),
      size: random(1, 3),
      twinkle: random(0.5, 1),
      twinkleSpeed: random(0.02, 0.05),
      emoji: '⭐'
    });
  }
  
  // Add fairy emojis to the twinkling collection
  for (let i = 0; i < 30; i++) {
    stars.push({
      x: random(-width/2, width/2),
      y: random(-height/2, height/2),
      size: random(1.5, 3.5),
      twinkle: random(0.5, 1),
      twinkleSpeed: random(0.01, 0.03),
      emoji: '🧚'
    });
  }
  
  // Create moon emoji
  moonEmoji = {
    x: 0,
    y: 0,
    size: 60
  };
}

function draw() {
  // Dark bluish-purple gradient background
  for (let i = 0; i <= height; i++) {
    let inter = map(i, 0, height, 0, 1);
    let c = lerpColor(color(25, 25, 60), color(10, 10, 25), inter);
    stroke(c);
    line(0, i, width, i);
  }
  
  translate(width / 2, height / 2);
  
  // Draw twinkling stars and fairies
  for (let star of stars) {
    star.twinkle += star.twinkleSpeed;
    let alpha = map(sin(star.twinkle), -1, 1, 150, 255);
    
    push();
    translate(star.x, star.y);
    textAlign(CENTER, CENTER);
    
    // Add gentle floating motion and special effects for fairies
    if (star.emoji === '🧚') {
      translate(sin(star.twinkle * 2) * 8, cos(star.twinkle * 1.5) * 5);
      fill(255, 150, 255, alpha); // Bright pink for fairies
      
      // Add glow effect for fairies
      drawingContext.shadowColor = `rgba(255, 150, 255, ${alpha/255})`;
      drawingContext.shadowBlur = 20;
      
      textSize(star.size * 10); // Larger fairies
    } else {
      fill(255, 255, 200, alpha); // Yellow for stars
      textSize(star.size * 8);
    }
    
    noStroke();
    text(star.emoji, 0, 0);
    
    // Reset shadow
    drawingContext.shadowBlur = 0;
    pop();
  }
  
  // Draw moon emoji at center
  push();
  textAlign(CENTER, CENTER);
  textSize(moonEmoji.size);
  text('🌙', moonEmoji.x, moonEmoji.y);
  pop();
  
  rotate(moonRotation);
  for (let platform of platforms) {
    platform.show();
  }
  rotate(-moonRotation);
  cat.update();
  cat.show();
  moonRotation += 0.002 + score * 0.0001;

  fill(255, 255, 150);
  textAlign(LEFT, TOP);
  textSize(20);
  textStyle(BOLD);
  text(`Score: ${score}`, -width / 2 + 20, -height / 2 + 20);
  
  // Check for brownie points (every 50 points)
  let currentBrowniePoints = Math.floor(score / 50);
  if (currentBrowniePoints > browniePoints) {
    browniePoints = currentBrowniePoints;
    showBrownieMessage = true;
    brownieMessageTimer = 180; // Show for 3 seconds (60fps * 3)
    brownieMessageAlpha = 255;
  }
  
  // Display brownie point message
  if (showBrownieMessage && brownieMessageTimer > 0) {
    brownieMessageTimer--;
    
    // Fade out effect
    if (brownieMessageTimer < 60) {
      brownieMessageAlpha = map(brownieMessageTimer, 0, 60, 0, 255);
    }
    
    // Pulsing and sparkling effect
    let pulseScale = 1 + sin(frameCount * 0.2) * 0.1;
    let sparkleOffset = sin(frameCount * 0.15) * 10;
    
    push();
    translate(0, sparkleOffset);
    scale(pulseScale);
    
    // Background box for message
    fill(255, 215, 0, brownieMessageAlpha * 0.8); // Gold background
    stroke(255, 255, 255, brownieMessageAlpha);
    strokeWeight(3);
    rect(-200, -50, 400, 100, 20);
    
    // Main message text
    fill(138, 43, 226, brownieMessageAlpha); // Purple text
    noStroke();
    textAlign(CENTER, CENTER);
    textSize(24);
    textStyle(BOLD);
    text("🏆 BROWNIE POINT! 🏆", 0, -20);
    
    textSize(20);
    fill(255, 20, 147, brownieMessageAlpha); // Deep pink
    text("⭐ MoonDustBeamcharger ⭐", 0, 10);
    
    textSize(16);
    fill(0, 191, 255, brownieMessageAlpha); // Sky blue
    text("✨ moondustBeamcharger ✨", 0, 35);
    
    pop();
    
    // Floating sparkle effects around the message
    for (let i = 0; i < 8; i++) {
      let angle = (frameCount * 0.05 + i * PI / 4);
      let x = cos(angle) * (80 + sin(frameCount * 0.1) * 20);
      let y = sin(angle) * (40 + cos(frameCount * 0.08) * 15);
      
      push();
      translate(x, y);
      rotate(frameCount * 0.1 + i);
      
      fill(255, 255, 255, brownieMessageAlpha * 0.8);
      textAlign(CENTER, CENTER);
      textSize(16 + sin(frameCount * 0.2 + i) * 4);
      
      if (i % 2 === 0) {
        text('⭐', 0, 0);
      } else {
        text('✨', 0, 0);
      }
      pop();
    }
    
    if (brownieMessageTimer <= 0) {
      showBrownieMessage = false;
    }
  }
  
  // Add MoonDustOdyssey text box beside score
  fill(255, 200, 255, 180); // Pink background
  stroke(255, 150, 255);
  strokeWeight(2);
  rect(-width / 2 + 20, -height / 2 + 55, 220, 35, 10); // Rounded rectangle
  
  fill(255, 255, 255);
  noStroke();
  textAlign(LEFT, CENTER);
  textSize(16);
  textStyle(NORMAL);
  text("🧚 MoonDustOdyssey 🧚", -width / 2 + 30, -height / 2 + 72);
  
  // Display brownie points counter
  fill(255, 215, 0, 200); // Gold background
  stroke(255, 255, 255);
  strokeWeight(1);
  rect(-width / 2 + 20, -height / 2 + 100, 180, 25, 8);
  
  fill(138, 43, 226); // Purple text
  noStroke();
  textAlign(LEFT, CENTER);
  textSize(14);
  textStyle(BOLD);
  text(`🏆 Brownie Points: ${browniePoints}`, -width / 2 + 25, -height / 2 + 112);
}

function keyPressed() {
  if (key === ' ' || key === 'ArrowUp') {
    cat.jump();
  }
}

class Cat {
  constructor() {
    this.r = 30;
    this.x = 0;
    this.y = 0;
    this.vy = 0;
  }

  jump() {
    if (this.onPlatform()) {
      this.vy = jumpForce;
      score++;
    }
  }

  onPlatform() {
    for (let p of platforms) {
      let px = p.x * cos(p.angle);
      let py = p.x * sin(p.angle);
      let d = dist(this.x, this.y + this.r / 2, px, py);
      if (d < this.r && this.vy >= 0) return true;
    }
    return false;
  }

  update() {
    this.vy += gravity;
    this.y += this.vy;
    if (this.y > height / 2) {
      this.y = 0;
      this.vy = 0;
      score = 0; // reset score on fall
    }
  }

  show() {
    fill('#38BDF8');
    ellipse(this.x, this.y, this.r, this.r);
    fill(0);
    ellipse(this.x - 5, this.y - 5, 5, 5);
    ellipse(this.x + 5, this.y - 5, 5, 5);
  }
}

class Platform {
  constructor(i) {
    this.angle = i * (PI / 4);
    this.x = 200; // distance from center
  }

  show() {
    let px = this.x * cos(this.angle);
    let py = this.x * sin(this.angle);
    fill(200, 200, 255, 180);
    stroke(255, 255, 255, 100);
    strokeWeight(2);
    ellipse(px, py, 40, 10);
  }
}
</script>
</body>
</html>
